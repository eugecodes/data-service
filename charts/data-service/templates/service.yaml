apiVersion: v1
kind: Service
metadata:
  name: "jdp-lifecycle-notification-service"
  labels:
    app: {{ template "lifecyclenotificationservice.name" . }}
    chart: {{ template "lifecyclenotificationservice.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
  annotations:
    co.elastic.monitor/id: autogenerated-id-from-stratopshere
    co.elastic.monitor/name: autogenerated-name-from-stratosphere
    co.elastic.monitor/check.response.status.0: "303"
    co.elastic.monitor/check.response.status.1: "307"
    co.elastic.monitor/check.response.status.2: "200"
    co.elastic.monitor/schedule: '@every 30s'
    co.elastic.monitor/ssl.verification_mode: none
    co.elastic.monitor/type: http
    co.elastic.monitor/urls: {{ .Values.global.stratosphere_virtual_service }}/lifecycleNotificationHealth
spec:
  type: {{ .Values.service.type }}
  ports:
    - port: {{ .Values.service.port }}
      targetPort: 15156
      protocol: TCP
      name: http
  selector:
    app: {{ template "lifecyclenotificationservice.name" . }}
    release: {{ .Release.Name }}
